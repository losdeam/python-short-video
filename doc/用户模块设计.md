## 流程图
### 整体
![](https://cdn.nlark.com/yuque/0/2023/jpeg/40362764/1698826484231-6c2efe57-3c3a-40b8-b111-3bfa64b919f7.jpeg)
### 后端
#### 注册
![](https://cdn.nlark.com/yuque/0/2023/jpeg/40362764/1698886456117-610257be-d944-456f-a5bd-26ce8634315f.jpeg)
#### 登录
![](https://cdn.nlark.com/yuque/0/2023/jpeg/40362764/1698830544793-f5578ef6-420a-4363-a57e-ba8a06420660.jpeg)

## 设计思路：
### 注册：

1. 用户需要输入邮箱通过前端提供的接口来获取验证码，验证码会临时储存在服务器上并在设定时间到达后进行释放。创建的同时验证码也会发送到用户所提供的邮箱中。
2. 当用户接受到邮箱中的验证码后点击注册按钮，即可实现验证码与用户信息的上传，并传递给后端按顺序进行邮箱验证码验证，用户存在性验证，与密码安全性验证。当三步验证中任何一步未通过时，返回对应的错误信息给客户端。当均通过时，将用户信息经加密后保存至数据库中，并由后端返回“注册成功”信息。
### 登录：

1. 用户需要输入邮箱与账号来实现登录
2. 首先后端将会进行用户存在性验证，若是不存在，则直接向客户端返回错误信息，若是存在，则读取数据库中邮箱对应的密码。
3. 将加密后的密码进行解码与客户端输入的密码进行验证，验证成功，则返回登录成功，并将用户的账号保存到cookie中以防止重复操作。若是验证失败，则返回密码错误。
## 模块设计：
#### 验证码生成模块

1.  在程序初始化时，将保存在flask_config.py文件中的邮箱配置读取至flask服务器中
2.  使用python自带的string与random库创建由大写字母与数字构成的长度为4的验证码
3. 使用flask_mail提供的Message函数，经由读取到的发送邮箱发送至用户提供的邮箱中
4. 将邮箱与验证码的映射以哈希表的形式保存至全局变量email_dict
5. 调用time库中的sleep函数实现定时删除功能，由于email_dict为全局变量，因此在阻塞过程中依然可以由外部函数进行调用

#### 邮箱验证码验证模块：

1. 服务器接受前端返回的json格式的数据包
2. 经解包后获取客户端返回的验证码与邮箱
3. 通过哈希表来查看用户所给邮箱在哈希表中所对应的验证码是否与客户端返回的验证码相同，相同则验证通过，进入下一步验证，不同则返回验证码错误

#### 用户存在性验证模块：

1. 接受上一步验证解包完的数据
2. 获取客户端返回的用户名与邮箱
3. 在数据库中查询是否存在相同的用户名或邮箱，若存在则返回"该用户名已存在"/"该邮箱已被注册"。若不存在则进入下一步验证

#### 密码安全性验证

1. 接受上一步验证解包完的数据
2. 获取客户端返回的密码，创建sorce变量，用于记录密码安全性得分
3. 判断密码长度，若小于8则返回(False,"密码长度至少需要8位")，若大于等于8，则将sorce加上密码长度
4. 判断密码中的字符种类数量，若小于2则返回(False,"密码需要包含多种字符类型")，若大于等于2，则将sorce加上10*字符种类数量（大写字母，小写字母，数字，特殊字符）
5. 判断密码是否为连续数字，若是则返回"密码不能连续数字"
6. 通过得分来判断密码安全性，大于等于45分则返回(True,非常安全的密码)，大于等于28分则返回(True,安全性一般的代码)




